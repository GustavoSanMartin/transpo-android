/*
 * Copyright (c) 2019 Derek Ellis. Subject to the MIT license.
 */

package ca.llamabagel.transpo.data

import okhttp3.mockwebserver.Dispatcher
import okhttp3.mockwebserver.MockResponse
import okhttp3.mockwebserver.MockWebServer
import okhttp3.mockwebserver.RecordedRequest

fun createMockServer(): MockWebServer {
    val server = MockWebServer()
    server.dispatcher = dispatcher

    return server
}

private val dispatcher = object : Dispatcher() {
    override fun dispatch(request: RecordedRequest): MockResponse = when (request.path) {
        "/trips/7196" -> MockResponse().setResponseCode(200).setBody(
            """
                {"stopCode":"7196","routes":[{"number":"44","directionId":0,"direction":"Southbound","heading":"Billings Bridge","trips":[{"destination":"Billings Bridge","startTime":"17:37","adjustedScheduleTime":25,"adjustmentAge":0.31,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.411798,"longitude":-75.66499,"gpsSpeed":37.8},{"destination":"Billings Bridge","startTime":"17:52","adjustedScheduleTime":30,"adjustmentAge":0.55,"lastTripOfSchedule":false,"busType":"","hasBikeRack":false,"punctuality":0,"latitude":45.415977,"longitude":-75.674179,"gpsSpeed":44.5},{"destination":"Billings Bridge","startTime":"18:07","adjustedScheduleTime":38,"adjustmentAge":0.4,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":false,"punctuality":0,"latitude":45.416352,"longitude":-75.706729,"gpsSpeed":20.3}]}],"inactiveRoutes":[],"responseTime":"Jun 12, 2019 10:21:55 PM"}
            """.trimIndent()
        )
        "/trips/3000" -> MockResponse().setResponseCode(200).setBody(
            """
                {"stopCode":"3000","routes":[{"number":"19","directionId":0,"direction":"Westbound","heading":"Parliament / Parlement","trips":[{"destination":"Parliament / Parlement","startTime":"23:15","adjustedScheduleTime":10,"adjustmentAge":0.1,"lastTripOfSchedule":false,"busType":"H","hasBikeRack":false,"punctuality":0,"latitude":45.436582,"longitude":-75.661583,"gpsSpeed":41.1},{"destination":"Parliament / Parlement","startTime":"22:15","adjustedScheduleTime":40,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"L","hasBikeRack":true,"punctuality":0}]},{"number":"19","directionId":1,"direction":"Eastbound","heading":"St-Laurent","trips":[{"destination":"St-Laurent","startTime":"23:38","adjustedScheduleTime":13,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0},{"destination":"St-Laurent","startTime":"24:08","adjustedScheduleTime":43,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"H","hasBikeRack":false,"punctuality":0}]},{"number":"44","directionId":0,"direction":"Southbound","heading":"Billings Bridge","trips":[{"destination":"Billings Bridge","startTime":"23:16","adjustedScheduleTime":6,"adjustmentAge":0.29,"lastTripOfSchedule":false,"busType":"H","hasBikeRack":false,"punctuality":0,"latitude":45.416547,"longitude":-75.706254,"gpsSpeed":44.5},{"destination":"Billings Bridge","startTime":"23:48","adjustedScheduleTime":32,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"","hasBikeRack":false,"punctuality":0},{"destination":"Billings Bridge","startTime":"24:16","adjustedScheduleTime":63,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"","hasBikeRack":false,"punctuality":0}]},{"number":"44","directionId":1,"direction":"Northbound","heading":"Gatineau","trips":[{"destination":"Terrasses de la Chaudière","startTime":"23:20","adjustedScheduleTime":27,"adjustmentAge":0.1,"lastTripOfSchedule":false,"busType":"H","hasBikeRack":false,"punctuality":0,"latitude":45.373045,"longitude":-75.648414,"gpsSpeed":19.2},{"destination":"Terrasses de la Chaudière","startTime":"23:50","adjustedScheduleTime":58,"adjustmentAge":-2.0,"lastTripOfSchedule":true,"busType":"H","hasBikeRack":false,"punctuality":0}]},{"number":"61","directionId":0,"direction":"Eastbound","heading":"St-Laurent","trips":[{"destination":"St-Laurent","startTime":"22:47","adjustedScheduleTime":6,"adjustmentAge":0.4,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.41423,"longitude":-75.709519,"gpsSpeed":24.6},{"destination":"St-Laurent","startTime":"22:39","adjustedScheduleTime":23,"adjustmentAge":0.17,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.35877,"longitude":-75.771597,"gpsSpeed":38.9},{"destination":"St-Laurent","startTime":"23:09","adjustedScheduleTime":41,"adjustmentAge":0.37,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.310145,"longitude":-75.905898,"gpsSpeed":23.5}]},{"number":"61","directionId":1,"direction":"Westbound","heading":"Terry Fox","trips":[{"destination":"Terry Fox","startTime":"23:29","adjustedScheduleTime":23,"adjustmentAge":-2.0,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0},{"destination":"Terry Fox","startTime":"24:00","adjustedScheduleTime":54,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0},{"destination":"Terry Fox","startTime":"24:24","adjustedScheduleTime":78,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0}]},{"number":"62","directionId":0,"direction":"Eastbound","heading":"St-Laurent","trips":[{"destination":"St-Laurent","startTime":"23:16","adjustedScheduleTime":33,"adjustmentAge":0.49,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":true,"punctuality":0,"latitude":45.320514,"longitude":-75.884309,"gpsSpeed":32.4},{"destination":"St-Laurent","startTime":"23:47","adjustedScheduleTime":61,"adjustmentAge":0.47,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.309574,"longitude":-75.906899,"gpsSpeed":0.5}]},{"number":"62","directionId":1,"direction":"Westbound","heading":"Stittsville","trips":[{"destination":"Terry Fox","startTime":"23:14","adjustedScheduleTime":10,"adjustmentAge":0.09,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.411749,"longitude":-75.665681,"gpsSpeed":31.3},{"destination":"Terry Fox","startTime":"23:44","adjustedScheduleTime":38,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"L","hasBikeRack":true,"punctuality":0}]},{"number":"85","directionId":1,"direction":"Westbound","heading":"Bayshore","trips":[{"destination":"Bayshore","startTime":"23:22","adjustedScheduleTime":4,"adjustmentAge":0.39,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":false,"punctuality":0,"latitude":45.421751,"longitude":-75.679922,"gpsSpeed":14.8},{"destination":"Bayshore","startTime":"23:52","adjustedScheduleTime":34,"adjustmentAge":5.19,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":false,"punctuality":0,"latitude":45.416319,"longitude":-75.669255,"gpsSpeed":2.7},{"destination":"Bayshore","startTime":"22:07","adjustedScheduleTime":65,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"S","hasBikeRack":false,"punctuality":0}]},{"number":"86","directionId":0,"direction":"Eastbound","heading":"Elmvale","trips":[{"destination":"Elmvale","startTime":"23:02","adjustedScheduleTime":8,"adjustmentAge":0.84,"lastTripOfSchedule":false,"busType":"H","hasBikeRack":false,"punctuality":0,"latitude":45.407181,"longitude":-75.726135,"gpsSpeed":46.7},{"destination":"Elmvale","startTime":"23:32","adjustedScheduleTime":38,"adjustmentAge":-2.0,"lastTripOfSchedule":true,"busType":"S","hasBikeRack":true,"punctuality":0}]},{"number":"86","directionId":1,"direction":"Westbound","heading":"Baseline","trips":[{"destination":"Baseline","startTime":"23:24","adjustedScheduleTime":23,"adjustmentAge":0.15,"lastTripOfSchedule":false,"busType":"","hasBikeRack":false,"punctuality":0,"latitude":45.399166,"longitude":-75.623166,"gpsSpeed":0.5},{"destination":"Baseline","startTime":"23:54","adjustedScheduleTime":54,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"H","hasBikeRack":false,"punctuality":0}]},{"number":"94","directionId":0,"direction":"Westbound","heading":"Riverview","trips":[{"destination":"Tunney\u0027s Pasture","startTime":"23:01","adjustedScheduleTime":17,"adjustmentAge":0.19,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.423102,"longitude":-75.597749,"gpsSpeed":46.7},{"destination":"Tunney\u0027s Pasture","startTime":"23:31","adjustedScheduleTime":46,"adjustmentAge":0.25,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":false,"punctuality":0,"latitude":45.465268,"longitude":-75.448211,"gpsSpeed":0.5},{"destination":"Tunney\u0027s Pasture","startTime":"24:01","adjustedScheduleTime":76,"adjustmentAge":-1.0,"lastTripOfSchedule":true,"busType":"N","hasBikeRack":false,"punctuality":0}]},{"number":"94","directionId":1,"direction":"Eastbound","heading":"Millennium","trips":[{"destination":"Millennium","startTime":"23:21","adjustedScheduleTime":8,"adjustmentAge":1.67,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.407889,"longitude":-75.724439,"gpsSpeed":42.2},{"destination":"Millennium","startTime":"23:51","adjustedScheduleTime":36,"adjustmentAge":0.2,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.404062,"longitude":-75.736154,"gpsSpeed":0.5},{"destination":"Millennium","startTime":"24:21","adjustedScheduleTime":66,"adjustmentAge":-1.0,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0}]},{"number":"95","directionId":0,"direction":"Eastbound","heading":"Orléans","trips":[{"destination":"Trim","startTime":"22:47","adjustedScheduleTime":17,"adjustmentAge":0.27,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.392512,"longitude":-75.759912,"gpsSpeed":45.6},{"destination":"Trim","startTime":"23:13","adjustedScheduleTime":26,"adjustmentAge":0.12,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":true,"punctuality":0,"latitude":45.343525,"longitude":-75.757475,"gpsSpeed":47.8},{"destination":"Place d\u0027Orléans","startTime":"23:34","adjustedScheduleTime":46,"adjustmentAge":0.49,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.266886,"longitude":-75.741539,"gpsSpeed":0.5}]},{"number":"95","directionId":1,"direction":"Westbound","heading":"Barrhaven Centre","trips":[{"destination":"Barrhaven Centre","startTime":"22:48","adjustedScheduleTime":2,"adjustmentAge":0.12,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":false,"punctuality":0,"latitude":45.424609,"longitude":-75.687088,"gpsSpeed":1.6},{"destination":"Barrhaven Centre","startTime":"23:03","adjustedScheduleTime":7,"adjustmentAge":0.34,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.41916,"longitude":-75.6542,"gpsSpeed":51.1},{"destination":"Barrhaven Centre","startTime":"23:18","adjustedScheduleTime":25,"adjustmentAge":0.19,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":false,"punctuality":0,"latitude":45.469473,"longitude":-75.546979,"gpsSpeed":36.7}]},{"number":"97","directionId":0,"direction":"Eastbound","heading":"Airport / Aéroport","trips":[{"destination":"Airport / Aéroport","startTime":"22:40","adjustedScheduleTime":4,"adjustmentAge":0.35,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.418202,"longitude":-75.702397,"gpsSpeed":21.3},{"destination":"Airport / Aéroport","startTime":"23:19","adjustedScheduleTime":30,"adjustmentAge":0.19,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.348543,"longitude":-75.807078,"gpsSpeed":0.5},{"destination":"Airport / Aéroport","startTime":"23:16","adjustedScheduleTime":40,"adjustmentAge":0.15,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":true,"punctuality":0,"latitude":45.327989,"longitude":-75.818874,"gpsSpeed":59.9}]},{"number":"97","directionId":1,"direction":"Westbound","heading":"Bells Corners","trips":[{"destination":"Bayshore","startTime":"23:02","adjustedScheduleTime":5,"adjustmentAge":0.24,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.420501,"longitude":-75.678854,"gpsSpeed":23.5},{"destination":"Bayshore","startTime":"23:17","adjustedScheduleTime":20,"adjustmentAge":0.57,"lastTripOfSchedule":false,"busType":"L","hasBikeRack":true,"punctuality":0,"latitude":45.361706,"longitude":-75.660596,"gpsSpeed":51.1},{"destination":"Bayshore","startTime":"23:32","adjustedScheduleTime":32,"adjustmentAge":0.49,"lastTripOfSchedule":false,"busType":"S","hasBikeRack":true,"punctuality":0,"latitude":45.322277,"longitude":-75.66586,"gpsSpeed":0.5}]}],"inactiveRoutes":[],"responseTime":"Jun 12, 2019 3:28:08 AM"}
            """.trimIndent()
        )
        "/feed?lang=en" -> MockResponse().setResponseCode(200).setBody(
            """
                [ { "title": "Route schedules list out of order", "date": "Jul 17, 2019 2:54:00 PM", "category": "General Message", "link": "https://www.octranspo.com/en/alerts#alert-route-schedules-list-out-of-order-1563375321215", "description": "July 17 2019 - \u003cp\u003eThe route schedules list is currently displaying out of sequence. The \u003ca href\u003d\"http://plan.octranspo.com/plan/RouteSchedules\"\u003eroute schedules listed in the Travel Planner\u003c/a\u003e \u003cstrong\u003eare\u003c/strong\u003e in \u003cstrong\u003ecorrect \u003c/strong\u003eorder. We are working to resolve this issue. Thank you for your patience.\u003c/p\u003e", "guid": "https://www.octranspo.com/en/alerts#alert-route-schedules-list-out-of-order-1563375321215", "affectedRoutes": [], "affectedStops": [] }, { "title": "Cope Drive Closure", "date": "Jul 16, 2019 5:01:00 PM", "category": "Detours", "link": "https://www.octranspo.com/en/alerts#alert-cope-drive-closure-1563297288975", "description": "July 16 2019 - \u003cp\u003eFrom\u003cstrong\u003e 6 am \u003c/strong\u003eon Monday, July 22 2019 until \u003cstrong\u003e6 pm \u003c/strong\u003eon Friday, August 16 2019, \u003cstrong\u003eRoutes 161, 164 and 256\u003c/strong\u003e\u003cstrong\u003e \u003c/strong\u003ewill be detoured\u003cstrong\u003e \u003c/strong\u003edue to the closure of Cope Drive between Eagleson and Akerson. Please allow a few extra minutes for your travel.\u003c/p\u003e\n\n\u003ch3\u003e\u003cstrong\u003eDetour routing\u003c/strong\u003e\u003c/h3\u003e\n\n\u003cul\u003e\n\t\u003cli\u003eRoute 161 Bridlewood will serve Eagleson/Cope, Eagleson, Fernbank, Templeford, Cope and Terry Fox.\u003c/li\u003e\n\t\u003cli\u003eRoute 161 Terry Fox will serve Cope/Templeford, Templeford, Fernbank and Eagleson.\u003c/li\u003e\n\t\u003cli\u003eRoute 164 Hope Side will serve Eagleson/Cope, Eagleson, Fernbank, Terry Fox, Cope and Templeford.\u003c/li\u003e\n\t\u003cli\u003eRoute 164 Terry Fox will serve Templeford/Cope, Cope, Fernbank and Eagleson.\u003c/li\u003e\n\t\u003cli\u003eRoute 256 Mackenzie King will serve Akerson/Cope, Cope, Templeford, Fernbank, Eagleson and Cadence Gate.\u003c/li\u003e\n\t\u003cli\u003eRoute 256 Bridlewood will serve Cadence Gate/Eagleson, Eagleson, Fernbank, Templeford, Cope and Akerson.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\u003cstrong\u003eAffected stops\u003c/strong\u003e\u003c/h3\u003e\n\n\u003ctable style\u003d\"width: 100%;\" summary\u003d\"Table showing stops not in use and their alternate stops\"\u003e\n\t\u003cthead\u003e\n\t\t\u003ctr\u003e\n\t\t\t\u003cth scope\u003d\"col\" style\u003d\"width: 40%; text-align: left;\"\u003eBus stops (560#) NOT in use\u003c/th\u003e\n\t\t\t\u003cth scope\u003d\"col\" style\u003d\"width: 40%; text-align: left;\"\u003eRoutes\u003c/th\u003e\n\t\t\t\u003cth scope\u003d\"col\" style\u003d\"text-align: left;\"\u003eAlternate service\u003c/th\u003e\n\t\t\u003c/tr\u003e\n\t\u003c/thead\u003e\n\t\u003ctbody\u003e\n\t\t\u003ctr\u003e\n\t\t\t\u003ctd\u003e# 6935 -- Cope (south side) and Carronbridge\u003c/td\u003e\n\t\t\t\u003ctd\u003e161, 164, 256\u003c/td\u003e\n\t\t\t\u003ctd style\u003d\"text-align: left;\"\u003e# 6933 -- Templeford and Cope\u003c/td\u003e\n\t\t\u003c/tr\u003e\n\t\t\u003ctr\u003e\n\t\t\t\u003ctd\u003e# 6936 -- Cope (north side) and Akerson \u003c/td\u003e\n\t\t\t\u003ctd\u003e161, 164\u003c/td\u003e\n\t\t\t\u003ctd style\u003d\"text-align: left;\"\u003e# 6933 -- Templeford and Cope\u003c/td\u003e\n\t\t\u003c/tr\u003e\n\t\t\u003ctr\u003e\n\t\t\t\u003ctd\u003e# 1919 -- Cope (south side) and Templeford \u003c/td\u003e\n\t\t\t\u003ctd\u003e161, 164\u003c/td\u003e\n\t\t\t\u003ctd style\u003d\"text-align: left;\"\u003e# 6933 -- Templeford and Cope\u003c/td\u003e\n\t\t\u003c/tr\u003e\n\t\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e\u003ca href\u003d\"/images/files/maps/detours/2019/cope_drive_closure_161.pdf\"\u003e\u003cimg alt\u003d\"Detour map for Cope Drive Closure (Route 161)\" src\u003d\"http://www.octranspo.com/images/files/maps/detours/2019/cope_drive_closure_161.png\" style\u003d\"width: 100%;\" /\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href\u003d\"/images/files/maps/detours/2019/cope_drive_closure_164.pdf\"\u003e\u003cimg alt\u003d\"Detour map for Cope Drive Closure (Route 164)\" src\u003d\"http://www.octranspo.com/images/files/maps/detours/2019/cope_drive_closure_164.png\" style\u003d\"width: 100%;\" /\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href\u003d\"/images/files/maps/detours/2019/cope_drive_closure_256.pdf\"\u003e\u003cimg alt\u003d\"Detour map for Cope Drive Closure (Route 256)\" src\u003d\"http://www.octranspo.com/images/files/maps/detours/2019/cope_drive_closure_256.png\" style\u003d\"width: 100%;\" /\u003e\u003c/a\u003e\u003c/p\u003e", "guid": "https://www.octranspo.com/en/alerts#alert-cope-drive-closure-1563297288975", "affectedRoutes": [], "affectedStops": [] } ]
            """.trimIndent()
        )
        else -> MockResponse().setResponseCode(404)
    }.addHeader("Content-Type", "application/json; charset=utf-8")
}